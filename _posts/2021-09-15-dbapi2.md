---
title: '[SQL] Pythonì—ì„œ PostgreSQLë¡œ CSV File executeí•˜ê¸°'
description: íŒŒì´ì¬ìœ¼ë¡œ CSV ëª¨ë“ˆì„ ì´ìš©í•´ CSV íŒŒì¼ì„ PostgreSQLë¡œ ì˜®ê¸°ëŠ” ë°©ë²•
categories:
 - Did Unknown
tags: [Did Unknown, Python, PostgreSQL, CSV, CSV ëª¨ë“ˆ, íŒŒì´ì¬]
mathjax: enable
# 0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£ğŸ”Ÿ
---

# 1ï¸âƒ£ CSV File ì¤€ë¹„

- ìœ ëª…í•œ 'titanic.csv'ì„ DBì— ì˜®ê²¨ë³¼ ê²ƒì´ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-09-15 00 10 03](https://user-images.githubusercontent.com/79494088/133284052-9f070993-3a13-4998-a6cc-fc5bd94db596.png)

# 2ï¸âƒ£ psycopg2 ì„¤ì¹˜

```
$ pip install psycopg2
$ pip install psycopg2-binary # ìœ„ installì´ ì§„í–‰ë˜ì§€ ì•Šì„ ì‹œ ì‹¤í–‰
```

# 3ï¸âƒ£ Postgres ì—°ê²°

- ê³„ì • ìƒì„± í›„ ì—°ê²°í•œë‹¤.

```py
import psycopg2

conn = = psycopg2.connect(
    host = 'chunee.db.elephantsql.com'
    user = 'fqislexi'
    password = '*****'
    database = 'fqislexi'

cur = connection.cursor() # ì»¤ì„œ ìƒì„±
```
# 4ï¸âƒ£ Table ìƒì„±

```py
cur.execute("DROP TABLE IF EXISTS passenger;") # ë§Œì•½ passenger tableì´ ìˆë‹¤ë©´ ì‚­ì œ

cur.execute("""CREATE TABLE passenger (
                Survived INT,
                Pclass INT,
                Name VARCHAR(128),
                Sex VARCHAR(12),
                Age FLOAT,
                SSAboard INT,
                PCAboard INT,
                Fare FLOAT);
			""")
```

# 5ï¸âƒ£ ë°ì´í„° ì‚½ì…

```py
with open('titanic.csv', 'r') as f:
    reader = csv.reader(f)
    next(reader) # Skip the header row.
    for row in reader:
        cur.execute(
        "INSERT INTO passenger (Survived, Pclass, Name, Sex, Age, SSAboard, PCAboard, Fare) VALUES (%s, %s, %s, %s, %s, %s, %s, %s)",
        row
        )

connection.commit()
```

# 6ï¸âƒ£ í™•ì¸

<img width="117" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-09-15 00 22 45" src="https://user-images.githubusercontent.com/79494088/133286273-7a7b8dda-7ef1-43ed-9be1-d73e303ae17b.png">

survived|pclass|name                                                    |sex   |age |ssaboard|pcaboard|fare    |
       0|     3|Mr. Owen Harris Braund                                  |male  |22.0|       1|       0|    7.25|
       1|     1|Mrs. John Bradley (Florence Briggs Thayer) Cumings      |female|38.0|       1|       0| 71.2833|
       1|     3|Miss. Laina Heikkinen                                   |female|26.0|       0|       0|   7.925|
       1|     1|Mrs. Jacques Heath (Lily May Peel) Futrelle             |female|35.0|       1|       0|    53.1|
       0|     3|Mr. William Henry Allen                                 |male  |35.0|       0|       0|    8.05|
       ...|     ...|...                                         |...  |...|       ...|       ...|  ...|


- ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.