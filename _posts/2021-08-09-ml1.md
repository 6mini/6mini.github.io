---
title: '[Machine Learning] ì„ í˜•íšŒê·€(Linear Regression)'
description: ì„ í˜•íšŒê·€ëª¨ë¸ê³¼ ì§€ë„í•™ìŠµì„ ì´í•´í•˜ê³  íšŒê·€ëª¨ë¸ì— ê¸°ì¤€ëª¨ë¸ì„ ì„¤ì •í•˜ë©° Scikit-learnì„ ì´ìš©í•´ ì„ í˜•íšŒê·€ëª¨ë¸ì„ ë§Œë“¤ê³  ì‚¬ìš©í•˜ë©° í•´ì„
categories:
 - Machine Learning
tags: [Machine Learning, Supervised Learning, ì„ í˜•íšŒê·€ëª¨ë¸, ì§€ë„í•™ìŠµ, ê¸°ì¤€ëª¨ë¸, Scikit learn]
mathjax: enable
# 0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£ğŸ”Ÿ
---

- íšŒê·€ì„ ì„ ê·¸ë¦¬ê¸° ìœ„í•œ ê³„ìˆ˜ë“¤ ($b_0$, $b_1$) êµ¬í•˜ëŠ” ê³µì‹?
- Tabular dataì˜ íŠ¹ì§•ì„ ì„¸ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ë©´?
- ì§€ë„í•™ìŠµ(Supervised Learning)ì—ëŠ” ë‘ ê°€ì§€ ë°©ì‹ì´ ìˆìŠµë‹ˆë‹¤: íšŒê·€(Regression) and ë¶„ë¥˜(Classification)
  - â€œHow Much / How Many?â€ (íšŒê·€)
  - â€œIs this A or B?â€ (ë¶„ë¥˜)
- íšŒê·€ë¶„ì„ê³¼, ë¶„ë¥˜ì˜ íƒ€ê²Ÿ íŠ¹ì„±ì€ ë¬´ì—‡ì´ ë‹¤ë¥¸ê°€ìš”?

# 1ï¸âƒ£ ì£¼íƒ íŒë§¤ ê°€ê²© ì˜ˆì¸¡

```py
import pandas as pd
# ì£¼ì–´ì§„ url ì£¼ì†Œë¥¼ ì´ìš©í•´ house prices ë°ì´í„° import
df = pd.read_csv('https://ds-lecture-data.s3.ap-northeast-2.amazonaws.com/house-prices/house_prices_train.csv')
df_t = pd.read_csv('https://ds-lecture-data.s3.ap-northeast-2.amazonaws.com/house-prices/house_prices_test.csv')

df.head()
df_t.head()
```

![](/assets/images/8.png)

![](/assets/images/9.png)

```py
# ì—¬ëŸ¬ íŠ¹ì„± ì¤‘ 'GrLivArea', 'LotArea', 'SalePrice'ë¥¼ ì‚¬ìš©
# SalePrice: ì˜ˆì¸¡í•´ì•¼ í•˜ëŠ” íƒ€ê²Ÿê°’ìœ¼ë¡œ ì£¼íƒíŒë§¤ê°€ê²©(ë‹¬ëŸ¬)
# LotArea: ì§‘ê³¼ ë§ˆë‹¹ì˜ ì‚¬ì´ì¦ˆ(square feet)
# GrLivArea: ì§€ìƒ ìƒí™œë©´ì (square feet)
df = df[['GrLivArea', 'LotArea', 'SalePrice']]
df_t = df_t[['GrLivArea', 'LotArea']]

# í…Œì´ë¸” í˜•í…Œ ì¶œë ¥, ì´ëŸ° í˜•íƒœì˜ ë°ì´í„° : tabular data
df
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 10 22 50](https://user-images.githubusercontent.com/79494088/128652118-8e656215-4c04-4473-8510-cb2b165c5be3.png)

## ì˜ˆì¸¡ ë°©ë²•

### 1. ê¸°ì¡´ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ì˜ˆì¸¡
- ë³´í†µ ì¢‹ì€ ê²°ê³¼ë¥¼ ë‚´ê¸°ë„ í•˜ì§€ë§Œ, ì‚¬ëŒë§ˆë‹¤ í¸ê²¬ì´ ì¡´ì¬í•˜ë©° ì˜¤ë¥˜ì— ë¹ ì§ˆ ìœ„í—˜ì´ ë†’ë‹¤.

### 2. í†µê³„ì •ë³´ë¥¼ í™œìš©

```py
df['SalePrice'].describe()

'''
count     1,460.0
mean    180,921.2
std      79,442.5
min      34,900.0
25%     129,975.0
50%     163,000.0
75%     214,000.0
max     755,000.0
Name: SalePrice, dtype: float64
'''

import matplotlib.pyplot as plt
import seaborn as sns

## SalePriceì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜
sns.displot(df['SalePrice'], kde=True)

## í‰ê· ê³¼, ì¤‘ê°„ê°’ ìˆ˜ì§ì„ 
plt.axvline(df['SalePrice'].mean(), color='blue')
plt.axvline(df['SalePrice'].median(), color='red');
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 10 26 11](https://user-images.githubusercontent.com/79494088/128652258-8b053aa2-e39b-4ecc-b603-c72bb850281d.png)

- ë§Œì¼ ê°€ê²©ì„ ì²˜ìŒìœ¼ë¡œ ì˜ˆì¸¡í•  ë•Œ, ê°€ì¥ ê°„ë‹¨í•˜ê³  ì§ê´€ì ì¸ ë°©ë²•ìœ¼ë¡œ í‰ê· ì´ë‚˜ ì¤‘ê°„ê°’ì„ ì´ìš©í•´ ë³´ëŠ” ê²ƒë„ ì¢‹ì€ ì„ íƒì¼ ê²ƒì´ë‹¤.

## ê¸°ì¤€ëª¨ë¸(Baseline Model)
- ì˜ˆì¸¡ëª¨ë¸ì„ êµ¬ì²´ì ìœ¼ë¡œ ë§Œë“¤ê¸° ì „ì— ê°€ì¥ ê°„ë‹¨í•˜ë©´ì„œë„ ì§ê´€ì ì´ë©´ì„œ ìµœì†Œí•œì˜ ì„±ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ê¸°ì¤€ì´ ë˜ëŠ” ëª¨ë¸
- í‰ê· ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ 'í‰ê· ê¸°ì¤€ëª¨ë¸'
- ë¬¸ì œë³„ë¡œ ê¸°ì¤€ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•œë‹¤.
  - ë¶„ë¥˜ë¬¸ì œ : íƒ€ê²Ÿì˜ ìµœë¹ˆ í´ë˜ìŠ¤
  - íšŒê·€ë¬¸ì œ : íƒ€ê²Ÿì˜ í‰ê· ê°’
  - ì‹œê³„ì—´íšŒê·€ë¬¸ì œ : ì´ì „ íƒ€ì„ ìŠ¤íƒ¬í”„ì˜ ê°’

```py
# predict: ìš°ë¦¬ê°€ ì •í•œ ê¸°ì¤€ëª¨ë¸ì¸ í‰ê· ìœ¼ë¡œ ì˜ˆì¸¡
predict = df['SalePrice'].mean()

# í‰ê· ê°’ìœ¼ë¡œ ì˜ˆì¸¡í•  ë•Œ ìƒ˜í”Œ ë³„ í‰ê· ê°’ê³¼ì˜ ì°¨ì´(error)ë¥¼ ì €ì¥
errors = predict - df['SalePrice']

errors

'''
0      -27,578.8
1         -578.8
2      -42,578.8
3       40,921.2
4      -69,078.8
          ...   
1455     5,921.2
1456   -29,078.8
1457   -85,578.8
1458    38,796.2
1459    33,421.2
Name: SalePrice, Length: 1460, dtype: float64
'''

# mean_absolute_error(MAE), errorì— ì ˆëŒ€ê°’ì„ ì·¨í•œ í›„ í‰ê· ì„ ê³„ì‚°
mean_absolute_error = errors.abs().mean()
```

- MAE(Mean Absolute Error, í‰ê· ì ˆëŒ€ì˜¤ì°¨)ëŠ” ì˜ˆì¸¡ Errorì˜ ì ˆëŒ€ê°’ í‰ê· ì„ ë‚˜íƒ€ëƒ„

$$Error = (price - guess)$$

$$
\begin{align}mae = (\frac{1}{n})\sum_{i=1}^{n}\left | price_{i} - guess_{i} \right |\end{align}
$$

```py
x = df['GrLivArea']
y = df['SalePrice']

predict = df['SalePrice'].mean()
errors = predict - df['SalePrice']
mean_absolute_error = errors.abs().mean()

sns.lineplot(x=x, y=predict, color='red')
sns.scatterplot(x=x, y=y, color='blue');
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 10 51 57](https://user-images.githubusercontent.com/79494088/128653268-7bbce9d8-17d1-4314-8eb6-cd8e431f2235.png)

```py
print(f'ì˜ˆì¸¡í•œ ì£¼íƒ ê°€ê²©ì´ ${predict:,.0f}ì´ë©° ì ˆëŒ€í‰ê· ì—ëŸ¬ê°€ ${mean_absolute_error:,.0f}ì„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')

# ì˜ˆì¸¡í•œ ì£¼íƒ ê°€ê²©ì´ $180,921ì´ë©° ì ˆëŒ€í‰ê· ì—ëŸ¬ê°€ $57,435ì„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```

- í‰ê· ì˜ˆì¸¡ì€ ì—ëŸ¬ê°€ ìƒë‹¹íˆ í¬ë‹¤.

```py
# ì£¼íƒ ê°€ê²©ì´ ì „ì²´ê³µê°„í¬ê¸°(LotArea)ì™€ ê°™ì€ ë‹¤ë¥¸ íŠ¹ì„±ê³¼ ì–´ë–¤ ìƒê´€ê´€ê³„(dependent)ê°€ ìˆì„ê¹Œ?

sns.set(style='whitegrid', context='notebook')
cols = ['GrLivArea', 'LotArea','SalePrice']
sns.pairplot(df[cols], height=2);
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 14 23 39](https://user-images.githubusercontent.com/79494088/128663374-7bfad9b7-4fad-488d-a77a-2ceaf351c408.png)

## ì˜ˆì¸¡ëª¨ë¸(Predictive Model) í™œìš©
- Scatter plotì— ê°€ì¥ ì˜ ë§ëŠ” (Base fit) ì§ì„ ì„ ê·¸ë ¤ì£¼ë©´ ê·¸ê²ƒì´ íšŒê·€ ì˜ˆì¸¡ëª¨ë¸ì´ ëœë‹¤.

### íšŒê·€ì§ì„ ì„ ë§Œë“œëŠ” ë°©ë²•
- íšŒê·€ë¶„ì„ì—ì„œ ì¤‘ìš”í•œ ê°œë…ì€ ì˜ˆì¸¡ê°’ê³¼ ì”ì°¨(Residual)
  - ì˜ˆì¸¡ê°’ : ë§Œë“¤ì–´ì§„ ëª¨ë¸ì´ ì¶”ì •í•˜ëŠ” ê°’
  - ì”ì°¨ : ì˜ˆì¸¡ê°’ê³¼ ê´€ì¸¡ê°’ì˜ ì°¨ì´<br>
  (ì˜¤ì°¨(Error) : ëª¨ì§‘ë‹¨ì—ì„œì˜ ì˜ˆì¸¡ê°’ê³¼ ê´€ì¸¡ê°’ì˜ ì°¨ì´)
- íšŒê·€ì„ ì€ ì”ì°¨ ì œê³±ë“¤ì˜ í•©ì¸ RSS(Residual sum of Squares)ë¥¼ ìµœì†Œí™”í•˜ëŠ” ì§ì„ 
  - RSS : SSE(Sum of Square Error)ë¼ê³ ë„ ë§í•˜ë©° ì´ ê°’ì´ íšŒê·€ëª¨ë¸ì˜ ë¹„ìš©í•¨ìˆ˜(Cost Function)ê°€ ëœë‹¤.
- ë¨¸ì‹ ëŸ¬ë‹ì—ì„œëŠ” ë¹„ìš©í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ëª¨ë¸ì„ ì°¾ëŠ” ê³¼ì •ì„ í•™ìŠµì´ë¼ê³  í•œë‹¤.

$${\displaystyle \operatorname {RSS} =\sum _{i=1}^{n}(\varepsilon _{i})^{2}=\sum _{i=1}^{n}(y_{i}-f(x_{i}))^{2}=\sum _{i=1}^{n}(y_{i}-(\alpha x_{i} + \beta))^{2}}$$

- ì—¬ê¸°ì„œ ê³„ìˆ˜ $a$ì™€ $b$ëŠ” RSSë¥¼ ìµœì†Œí™”í•˜ëŠ” ê°’ìœ¼ë¡œ ëª¨ë¸ í•™ìŠµì„ í†µí•´ ì–»ì–´ì§€ëŠ” ê°’.
- ì”ì°¨ ì œê³±í•©ì„ ìµœì†Œí™”í•˜ëŠ” ë°©ë²•ì„ ìµœì†Œì œê³±íšŒê·€ or OLS(Ordinary Least Squares)ë¼ê³  ë¶€ë¥¸ë‹¤.
- OLSëŠ” ê³„ìˆ˜ ê³„ì‚°ì„ ìœ„í•´ ë‹¤ìŒ ê³µì‹ì„ ì‚¬ìš©í•œë‹¤.

{% raw %}$$\beta =\displaystyle {\bar {y}}-\alpha{\bar {x}}$${% endraw %}

{% raw %}$$\alpha ={\frac {S_{xy}}{S_{xx}}}$${% endraw %}

{% raw %}$${\displaystyle S_{xy}=\sum _{i=1}^{n}(x_{i}-{\bar {x}})(y_{i}-{\bar {y}})}$${% endraw %}

{% raw %}$${\displaystyle S_{xx}=\sum _{i=1}^{n}(x_{i}-{\bar {x}})^{2}}$${% endraw %}

- ìµœì†Œì œê³±ë²•ìœ¼ë¡œ ì„ í˜• íšŒê·€ê³„ìˆ˜ë¥¼ ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤.

```py
# Seaborn regplotìœ¼ë¡œ ê·¸ë¦¬ë©´, 
sns.regplot(x=df['GrLivArea'], y=df['SalePrice']);
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 13 33 02](https://user-images.githubusercontent.com/79494088/128660669-9be27d55-f279-4fb2-ad64-3d55751b5869.png)

```py
# GrLivArea > 3500 & GrLivArea < 4500 ì‚¬ì´ì˜ ë°ì´í„°
df[(df['GrLivArea'] > 3500) & (df['GrLivArea'] < 4500)]
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 13 33 54](https://user-images.githubusercontent.com/79494088/128660732-d004e108-4b92-44d7-9a62-f6b65374159a.png)

- ì„ í˜•íšŒê·€ëŠ” ì£¼ì–´ì ¸ ìˆì§€ ì•Šì€ ì ì˜ í•¨ìˆ˜ê°’ì„ ë³´ê°„(Interpolate)í•˜ì—¬ ì˜ˆì¸¡í•˜ëŠ”ë° ë„ì›€ì„ ì¤€ë‹¤.
- ì„ í˜•íšŒê·€ëª¨ë¸ì„ ì‚¬ìš©í•´ 4000sqft ì£¼íƒ ê°€ê²©ì„ ì–´ë¦¼ì¡ì•„ ì˜ˆì¸¡í•´ ë³¼ ìˆ˜ ìˆë‹¤.
- ì„ í˜•íšŒê·€ëª¨ë¸ì€ ê¸°ì¡´ ë°ì´í„°ì˜ ë²”ìœ„ë¥¼ ë„˜ì–´ì„œëŠ” ê°’ì„ ì˜ˆì¸¡í•˜ê¸° ìœ„í•œ ì™¸ì‚½(Extrapolate)ë„ ì œê³µí•œë‹¤.

# 2ï¸âƒ£ Scikit-Learn í™œìš© ì„ í˜•íšŒê·€ëª¨ë¸
- í˜„ì¬ ë‹¤ë£¨ëŠ” ë°ì´í„°ì— 6000sqft ì´ìƒì¸ ì£¼íƒì˜ ê±°ë˜ ì •ë³´ê°€ ì—†ë‹¤.

## ì´ëŸ° ê²½ìš° ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•
- ì„ í˜•íšŒê·€ ì§ì„ ì€ ë…ë¦½ë³€ìˆ˜(Independent Variable, $x$)ì™€ ì¢…ì†ë³€ìˆ˜(Dependent Variable, $y$) ê°„ì˜ ê´€ê³„ë¥¼ ìš”ì•½í•´ì¤€ë‹¤.
  - ì¢…ì†ë³€ìˆ˜
    - ì—°êµ¬ìê°€ ë…ë¦½ë³€ìˆ˜ì˜ ë³€í™”ì— ë”°ë¼ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ ì•Œê³  ì‹¶ì–´í•˜ëŠ” ë³€ìˆ˜
    - ë°˜ì‘ë³€ìˆ˜(Response), Label, Target ë“±
  - ë…ë¦½ë³€ìˆ˜
    - ì—°êµ¬ìê°€ ì˜ë„ì ìœ¼ë¡œ ë³€í™”ì‹œí‚¤ëŠ” ë³€ìˆ˜
    - ë‹¤ë¥¸ ë³€ìˆ˜ì— ì˜í–¥ì„ ë°›ì§€ ì•Šê³  ì˜¤íˆë ¤ ì¢…ì†ë³€ìˆ˜ì— ì˜í–¥ì„ ì¤€ë‹¤.
    - ì˜ˆì¸¡ë³€ìˆ˜(Predictor), ì„¤ëª…(Explanatory), íŠ¹ì„±(Feature) ë“±

## Scikit-Learn Data êµ¬ì¡°

<img src="https://www.researchgate.net/publication/301946040/figure/fig1/AS:362519232303116@1463442728351/Data-representation-in-scikit-learn.png" alt="Data representation in scikit-learn"/>

- Scikit-Learnì„ í™œìš©í•´ ëª¨ë¸ì„ ë§Œë“¤ê³  ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê¸° ìœ„í•´ì„œëŠ” ìœ„ì™€ ê°™ì€ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤. 
- íŠ¹ì • ë°ì´í„°ì™€ íƒ€ê²Ÿ ë°ì´í„°ë¥¼ ë‚˜ëˆ„ì–´ì¤€ë‹¤.
- íŠ¹ì„±í–‰ë ¬ì€ ì£¼ë¡œ `X`ë¡œ í‘œí˜„í•˜ê³  ë³´í†µ 2ì°¨ì› í–‰ë ¬ì´ë‹¤.<br>
ì£¼ë¡œ Numpy í–‰ë ¬ì´ë‚˜ Pandas ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ í‘œí˜„
- íƒ€ê²Ÿë°°ì—´ì€ ì£¼ë¡œ `y`ë¡œ í‘œí˜„í•˜ê³  ë³´í†µ 1ì°¨ì› í˜•íƒœì´ë‹¤.<br>
ì£¼ë¡œ Numpy í–‰ë ¬ì´ë‚˜ Pandas ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ í‘œí˜„

## Scikit-Learnì˜ ìˆ˜ë§ì€ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸
- ëª¨ë‘ ìœ ì‚¬í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 
- ì í•©í•œ ëª¨ë¸ì„ ì„ íƒí•˜ì—¬ í´ë˜ìŠ¤ë¥¼ ì°¾ì•„ë³¸ í›„ ê´€ë ¨ ì†ì„±ì´ë‚˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ í™•ì¸í•œë‹¤.
- `fit()` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ í•™ìŠµ
- `predict()` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„° ì˜ˆì¸¡
- [Scikit-Learn ì†Œê°œ](https://jakevdp.github.io/PythonDataScienceHandbook/05.02-introducing-scikit-learn.html#Basics-of-the-API)

# 3ï¸âƒ£ Simple Linear Regression (ë‹¨ìˆœ ì„ í˜• íšŒê·€)
- [sklearn.linear_model.LinearRegression](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html)

```py
# Scikit-Learn ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì‚¬ìš©í•  ì˜ˆì¸¡ëª¨ë¸ í´ë˜ìŠ¤ Import
from sklearn.linear_model import LinearRegression

# ì˜ˆì¸¡ëª¨ë¸ ì¸ìŠ¤í„´ìŠ¤
model = LinearRegression()

# X íŠ¹ì„±ë“¤ì˜ í…Œì´ë¸”ê³¼, y íƒ€ê²Ÿ ë²¡í„° ìƒì„±
feature = ['GrLivArea']
target = ['SalePrice']
X_train = df[feature]
y_train = df[target]

# ëª¨ë¸í•™ìŠµ(fit)
model.fit(X_train, y_train)

# LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)

# ìƒˆë¡œìš´ ë°ì´í„° í•œ ìƒ˜í”Œì„ ì„ íƒí•´ í•™ìŠµí•œ ëª¨ë¸ì„ í†µí•´ ì˜ˆì¸¡
X_test = [[4000]]
y_pred = model.predict(X_test)

print(f'{X_test[0][0]} sqft GrLivAreaë¥¼ ê°€ì§€ëŠ” ì£¼íƒì˜ ì˜ˆìƒ ê°€ê²©ì€ ${int(y_pred)} ì…ë‹ˆë‹¤.')

# 4000 sqft GrLivAreaë¥¼ ê°€ì§€ëŠ” ì£¼íƒì˜ ì˜ˆìƒ ê°€ê²©ì€ $447090 ì…ë‹ˆë‹¤.

# ì „ì²´ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ëª¨ë¸ì„ í†µí•´ ì˜ˆì¸¡
X_test = [[x] for x in df_t['GrLivArea']]
y_pred = model.predict(X_test)

# ì „ì²´ ì˜ˆì¸¡ê°’
y_pred

'''
array([[114557.82748987],
       [160945.27292207],
       [193084.38061182],
       ...,
       [149696.58523066],
       [122485.47405334],
       [232829.74378814]])
'''

# train ë°ì´í„°ì™€ ì˜ˆì¸¡ì— ëŒ€í•œ ê·¸ë˜í”„
plt.scatter(X_train, y_train, color='black', linewidth=1)
plt.scatter(X_test, y_pred, color='blue', linewidth=1);
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 13 59 08](https://user-images.githubusercontent.com/79494088/128661948-c17210d7-bc4b-4773-9f16-a6b6f3790ad4.png)

- ìœ„ ì½”ë“œëŠ” ì´ [ë‹¤ì´ì–´ê·¸ë¨](https://ogrisel.github.io/scikit-learn.org/sklearn-tutorial/tutorial/text_analytics/general_concepts.html#supervised-learning-model-fit-x-y)ì—ì„œ í‘œí˜„í•œ ì¼ë°˜ì ì¸ ë¨¸ì‹ ëŸ¬ë‹ í”„ë¡œì„¸ìŠ¤

<img src="https://ogrisel.github.io/scikit-learn.org/sklearn-tutorial/_images/plot_ML_flow_chart_12.png" width="75%">

- ë¨¸ì‹ ëŸ¬ë‹ì„ ìƒˆë¡œìš´ í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„ìœ¼ë¡œì¨ì˜ ê´€ì 

<img src="https://pbs.twimg.com/media/ECQDlFOWkAEJzlY.jpg" width="70%">

- ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê³  ì–´ë–¤ ë£°ì— ë”°ë¼ ë‹µì„ êµ¬í•´ë‚´ëŠ” ì¼ë°˜ì ì¸ í”„ë¡œê·¸ë˜ë°ê³¼ ë‹¬ë¦¬ ë¨¸ì‹ ëŸ¬ë‹ì€ ë°ì´í„°ì™€ ë‹µì„ í†µí•´ ë£°ì„ ì°¾ì•„ë‚´ëŠ” ë°©ë²•

# ì„ í˜•íšŒê·€ëª¨ë¸ì˜ ê³„ìˆ˜(Coefficients)
- ëª¨ë¸ì´ ì£¼íƒì˜ í¬ê¸°ì™€ ê°€ê²© ì‚¬ì´ì˜ ì–´ë–¤ ê´€ê³„ë¥¼ í•™ìŠµí–ˆëŠ”ì§€ ë³´ê¸° ìœ„í•´ `LinearRegression` ê°ì²´ì˜ `coef_`, `intercept_` ì†ì„±ì„ í™•ì¸

```py
# ê³„ìˆ˜(coefficient)
model.coef_

# array([[107.13035897]])

# ì ˆí¸(intercept)
model.intercept_

# array([18569.02585649])
```

## Coefficientsì˜ ì˜í–¥
- ì˜ˆì¸¡í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ìƒˆë¡œìš´ ë°ì´í„° ë°˜ë³µí•´ì„œ ì˜ˆì¸¡

```py
def explain_prediction(sqft):
    y_pred = model.predict([[sqft]])
    pred = f"{int(sqft)} sqft ì£¼íƒ ê°€ê²© ì˜ˆì¸¡: ${int(y_pred[0])} (1 sqftë‹¹ ì¶”ê°€ê¸ˆ: ${int(model.coef_[0])})"

    return pred

# square_feet = 4000 ì¸ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ì˜ˆì¸¡
print(explain_prediction(4000))

# 4000 sqft ì£¼íƒ ê°€ê²© ì˜ˆì¸¡: $447090 (1 sqftë‹¹ ì¶”ê°€ê¸ˆ: $107)
```

## ipywidgets ì‚¬ìš©

```py
from ipywidgets import interact

# ë°ì½”ë ˆì´í„° interactë¥¼ ì¶”ê°€
@interact
def explain_prediction(sqft=(500,10000)):
    y_pred = model.predict([[sqft]])
    pred = f"{int(sqft)} sqft ì£¼íƒ ê°€ê²© ì˜ˆì¸¡: ${int(y_pred[0])} (1 sqftë‹¹ ì¶”ê°€ê¸ˆ: ${int(model.coef_[0])})"

    return pred
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-08-09 14 14 39](https://user-images.githubusercontent.com/79494088/128662853-1ca5c8f4-7aa0-4b81-a559-9347b256302c.png)

# 4ï¸âƒ£ ì°¸ê³ ìë£Œ

#### ê¸°ì¤€ëª¨ë¸
- [Always start with a stupid model, no exceptions](https://blog.insightdatascience.com/always-start-with-a-stupid-model-no-exceptions-3a22314b9aaa)

#### Scikit-Learn
- [Python Data Science Handbook, Chapter 5.2: Introducing Scikit-Learn](https://jakevdp.github.io/PythonDataScienceHandbook/05.02-introducing-scikit-learn.html#Basics-of-the-API)
- [2.4.2.2. Supervised Learning](https://ogrisel.github.io/scikit-learn.org/sklearn-tutorial/tutorial/text_analytics/general_concepts.html#supervised-learning-model-fit-x-y)
- [sklearn.linear_model.LinearRegression](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html)
- [sklearn.metrics.mean_absolute_error](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_absolute_error.html)

#### ì½ì–´ë³´ì„¸ìš”
- [Art of Choosing Metrics in Supervised Models](https://towardsdatascience.com/art-of-choosing-metrics-in-supervised-models-part-1-f960ae46902e)
- [The Discovery of Statistical Regression](https://priceonomics.com/the-discovery-of-statistical-regression/)

#### ìµœì†Œì œê³±ë²•
- [ìˆ˜í•™ì‚°ì±…-ìµœì†Œì œê³±ë²•](https://terms.naver.com/entry.nhn?cid=58944&docId=3569970&categoryId=58970)

#### (ì°¸ê³ ) ë” ì„¸ë ¨ëœ ì‹œê°í™”íˆ´: Plotly
- [Plotly Express](https://plot.ly/python/plotly-express/)
- [plotly_express.scatter](https://www.plotly.express/plotly_express/#plotly_express.scatter)

#### ipywidgets interact
- [Using Interact](https://ipywidgets.readthedocs.io/en/stable/examples/Using%20Interact.html#Using-Interact)