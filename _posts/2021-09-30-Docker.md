---
title: 'Docker basic'
description: Docker Hubì—ì„œ imageë¥¼ ê²€ìƒ‰í•œ ë’¤ ì‚¬ìš©, Container êµ¬ì¶•
categories:
 - Data Engineering
tags: [Data Engineering, Docker, Docker Hub, Container, Image]
mathjax: enable
# 0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£ğŸ”Ÿ
---

# Dokerë€?
- APP ì‹¤í–‰í™˜ê²½ì„ ì½”ë“œë¡œ ì‘ì„±í•  ìˆ˜ ìˆê³  OSë¥¼ ê²©ë¦¬í™”í•˜ì—¬ ê´€ë¦¬í•˜ëŠ” ê¸°ìˆ 

### í™˜ê²½ í‘œì¤€í™”
- ì—”ì§€ë‹ˆì–´ëŠ” ê°œë°œí•˜ëŠ” APPì´ ì–´ë–¤ í™˜ê²½ì—ì„œ êµ¬ë™ë  ì§€ ìƒê°í•œ í›„ ê°œë°œí•´ì•¼ í•œë‹¤.

### ìˆ˜ì‘ì—…ìœ¼ë¡œ ì¼ì¹˜ì‹œí‚¤ëŠ” í™˜ê²½ êµ¬ì„±
- ì»´í“¨í„°ì— ë‹¤ì–‘í•œ ì„¤ì • ì‘ì—…ì„ ìˆ˜ì‘ì—…ìœ¼ë¡œ í•˜ê²Œëœë‹¤ë©´ ë§ì€ ì‹œê°„ì´ ê±¸ë¦´ë¿ë§Œ ì•„ë‹ˆë¼ ì„¤ì •ë“¤ì´ ë’¤ì—‰í‚¬ ìˆ˜ ìˆë‹¤.

### ë¦¬ì†ŒìŠ¤ ê²©ë¦¬ì„±

>Web server 1ì€ IPëŠ” Aë¡œ í•˜ê³  í¬íŠ¸ ë²ˆí˜¸ëŠ” A-1ë¡œ í•˜ê³ , ë°©í™”ë²½ ê·œì¹™ì€ aì˜ ê·œì¹™ì„ ì´ìš©í•˜ì„¸ìš”.<br>
>Web server 2ì€ IPëŠ” Bë¡œ í•˜ê³  í¬íŠ¸ ë²ˆí˜¸ëŠ” B-1ë¡œ í•˜ê³ , ë°©í™”ë²½ ê·œì¹™ì€ bì˜ ê·œì¹™ì„ ì´ìš©í•˜ì„¸ìš”.

- ì´ì™€ ê°™ì€ ìš”êµ¬ê°€ ìƒê¸´ë‹¤ë©´ ë¦¬ì†ŒìŠ¤ ê²©ë¦¬ì„±ì´ í•„ìš”í•˜ë‹¤.
- ë¦¬ì†ŒìŠ¤ ê²©ë¦¬ì„±ì„ ì œê³µí•˜ëŠ” ê¸°ìˆ ë¡œ ê°€ìƒë¨¸ì‹ , Docker ë“±ì´ ìˆë‹¤.
- ê°€ìƒë¨¸ì‹  : VB, VMê³¼ ê°™ì€ ê°€ìƒë¨¸ì‹ ì€ ê°œë°œ í˜¹ì€ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì„ Imageë¡œ ì €ì¥í•˜ê³  Host OS ìœ„ì— ê²ŒìŠ¤íŠ¸ OSë¥¼ ë„ìš°ëŠ” ë°©ì‹

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-09-30 11 15 12](https://user-images.githubusercontent.com/79494088/135374542-e456921f-254f-4b41-bec9-49dc308e9389.png)

- ê°€ìƒí™” ë°©ë²•ê³¼ DockerëŠ” ê²©ë¦¬ì„±ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ê° APP ë§ˆë‹¤ ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ IP, Port ë“±ì„ ë‹¤ë¥´ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
- DockerëŠ” ê°€ìƒë¨¸ì‹ ë§Œí¼ ê²¬ê³ í•œ ê²©ë¦¬ì„±ì„ ì œê³µí•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.
- DockerëŠ” Linuxì˜ Containerë¥¼ ì´ìš©í•œ ê¸°ìˆ ë¡œ OS ìœ„ì— ë‹¤ë¥¸ OSë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ê°€ìƒë¨¸ì‹ ë³´ë‹¤ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆë‹¤.

# Linux Container

## What is?
- Linux ê¸°ë°˜ì˜ ê¸°ìˆ  ì¤‘ í•˜ë‚˜ë¡œ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ APPì„ ëª¨ì•„ ë§ˆì¹˜ ë³„ë„ì˜ serverì²˜ëŸ¼ êµ¬ì„±í•œ ê²ƒ
- Containerë¥¼ ì´ë£¨ëŠ” Network ì„¤ì •, í™˜ê²½ ë³€ìˆ˜ ë“± ì‹œìŠ¤í…œ ìì›ì€ ê° Containerê°€ ë…ë¦½ì ìœ¼ë¡œ ì†Œìœ 
- Process êµ¬íší™”
  - íŠ¹ì • Containerì—ì„œ ì‘ë™í•˜ëŠ” processëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê·¸ Container ì•ˆì—ì„œë§Œ Access í•  ìˆ˜ ìˆë‹¤.
  - Container ì•ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” processëŠ” ë‹¤ë¥¸ Containerì˜ processì—ê²Œ ì˜í–¥ì„ ì¤„ ìˆ˜ ì—†ë‹¤.
- Networkì˜ êµ¬íší™”
  - ê¸°ë³¸ìœ¼ë¡œ Container í•˜ë‚˜ì— IP ì£¼ì†Œê°€ í• ë‹¹ë˜ì–´ ìˆë‹¤.
- íŒŒì¼ ì‹œìŠ¤í…œì˜ êµ¬íší™”
  - í•´ë‹¹ Containerì—ì„œì˜ ëª…ë ¹ì´ë‚˜ íŒŒì¼ ë“±ì˜ ì•¡ì„¸ìŠ¤ë¥¼ ì œí•œí•  ìˆ˜ ìˆë‹¤.

### Dockerë§Œì˜ íŠ¹ì§•
- APPì— ëŒ€í•œ í™˜ê²½ì„ ê²©ë¦¬ì„±ì„ ì¤‘ì‹¬ìœ¼ë¡œí•œ VMì˜ ê´€ì  ë³´ë‹¤ëŠ” Containerì˜ ê´€ì ì—ì„œ ë¹ ë¥´ê³ , ê°œë°œìì™€ ì‚¬ìš©ì ì»¤ë®¤ë‹ˆí‹°ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í˜œíƒì„ ì œê³µ
- [Docker HUB](https://hub.docker.com/)

# Docker CLI
- [Docker docs](https://docs.docker.com/engine/reference/commandline/container_run/)
- ì‚¬ìš©ë²• : Docker CLI, Docker-Compose CLI, API Reperence
- í™˜ê²½ ë° ë¹Œë“œ íŒŒì¼ êµ¬ì„± : DockerFile, Docker-Compose File

## Use to Docker

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-09-30 11 40 02](https://user-images.githubusercontent.com/79494088/135377010-64f27018-9b4d-4b76-a6b3-aaf0195bfdfb.png)

### docker/whalesay

- Imageê°€ ì œê³µë˜ì—ˆì„ ë•Œ ì½ëŠ” ë²•
- Registry ê³„ì •, repo ì´ë¦„, tag ì„¸ ê°€ì§€ ì •ë³´ë¡œ êµ¬ì„±

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-09-30 11 41 16](https://user-images.githubusercontent.com/79494088/135377141-462d66e6-9af6-4ec7-9909-aa87cc55a8e4.png)

- Registry
  - Docker imageê°€ ê´€ë¦¬ë˜ëŠ” ê³µê°„
  - Docker Hubì„ ê¸°ë³¸ registryë¡œ ì„¤ì •
  - Docker Hub, Private Docker Hub, íšŒì‚¬ ë‚´ë¶€ìš© Registry ë“±ìœ¼ë¡œ ë‚˜ë‰¨
- Repository
  - Registry ë‚´ Docker imageê°€ ì €ì¥ë˜ëŠ” ê³µê°„
  - Image ì´ë¦„ì´ ì‚¬ìš©ë˜ê¸°ë„ í•œë‹¤.
  - Githubì˜ repoì™€ ìœ ì‚¬
- Tag
  - ê°™ì€ imageë¼ê³  í•  ì§€ë¼ë„ version ë³„ë¡œ ë‚´ìš©ì´ ì¡°ê¸ˆ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.
  - í•´ë‹¹ imageë¥¼ ì„¤ëª…í•˜ëŠ” version ì •ë³´ë¥¼ ì£¼ë¡œ ì…ë ¥
  - ë‹¤ë¥¸ ê²ƒì„ ì§€ì •í•˜ì§€ ì•Šì€ë‹¤ë©´ `latest` tagë¥¼ ë¶™íŒ imageë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- docker/whalesay : Docker Hubë¼ëŠ” registryì—ì„œ dockerë¼ëŠ” ë¶„ì´ ì˜¬ë¦¬ì‹  whalesay image í˜¹ì€ repositoryì—ì„œ latest tagë¥¼ ê°€ì§„ image

#### Docker Example ìˆ˜í–‰í•˜ê¸° : docker/whalesay

```
$ docker image pull docker/whalesay:latest

$ docker image ls
```

- `image pull` : registryì—ì„œ image í˜¹ì€ reopsitoryë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- `image ls` : image list
- ë°›ì•„ì˜¨ image ì‹¤í–‰(image -> container)

```
$ docker container run --name myName docker/whalesay:latest cowsay boo
```

- `container run` : containerë¥¼ ì‹¤í–‰
- OPTION
  - `--name` : containerì˜ ì´ë¦„ì„ í• ë‹¹
- COMMAND
  - `cowsay` : containerì—ì„œ cowsayë¥¼ í˜¸ì¶œ(pythonì„ í˜¸ì¶œí•˜ë“¯ ì´ìš©í•˜ëŠ” ê²ƒ)
- ARG
  - `boo` : COMMAND ì¸ cowsay ì— ë„˜ê²¨ì§ˆ íŒŒë¼ë¯¸í„°

```
 _____ 
< boo >
 ----- 
    \
     \
      \     
                    ##        .            
              ## ## ##       ==            
           ## ## ## ##      ===            
       /""""""""""""""""___/ ===        
  ~~~ {~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~   
       \______ o          __/            
        \    \        __/             
          \____\______/   

```

```
$ docker container ps -a

$ docker container rm myName
```

- `container ps` : container list
  - `-a` : Defaultë¡œëŠ” ì‹¤í–‰ë˜ëŠ” containerì§€ë§Œ ì¢…ë£Œ ëœ containerë¥¼ í¬í•¨í•˜ì—¬ ëª¨ë“  containerë¥¼ ì¶œë ¥
- `container rm` : containerë¥¼ ì§€ì¹­í•´ì„œ ì‚­ì œ. containerë¥¼ ëª…ì‹œí•  ë•ŒëŠ” ps ëª…ë ¹ì„ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆëŠ” NAMES í˜¹ì€ CONTAINER ID ë¥¼ ì‚¬ìš©

```py
# docker image ìš©ëŸ‰ í™•ì¸
$ docker image ls

# docker/whalesay image ì§€ìš°ê¸°
$ docker image rm docker/whalesay
```

- imageë¥¼ ë°›ì•„ì˜¤ê³ , containerë¡œ ì‹¤í–‰í•˜ê³ , containerì™€ ê´€ë ¨ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ì§€ìš°ëŠ” ì‘ì—…ì„ í•œë²ˆì— ì‹¤í–‰

```
$ docker container run --name my_name --rm docker/whalesay cowsay boo
```

- `container run` : container ì‹¤í–‰. imageê°€ ì—†ë‹¤ë©´ imageë¥¼ ë°›ì•„ì˜¨ ë’¤(pull) ì‹¤í–‰
- `--rm` : containerë¥¼ ì¼íšŒì„±ìœ¼ë¡œ ì‹¤í–‰. containerê°€ ì¢…ë£Œë  ë•Œ containerì™€ ê´€ë ¨ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ëª¨ë‘ ì œê±°

```
$ docker image rm docker/whalesay
```

- `image rm` : ì§€ì •ëœ docker image ì‚­ì œ

#### Docker Example ìˆ˜í–‰í•˜ê¸° : danielkraic/asciiquarium

```
$ docker container run -it --rm danielkraic/asciiquarium:latest
```

- `-it` : -i, -t ë¥¼ í†µì‹œì— ì‚¬ìš©í•œ ê²ƒìœ¼ë¡œ í„°ë¯¸ë„ ì…ë ¥ì„ ìœ„í•œ ì˜µì…˜. ì‚¬ìš©ìì™€ container ê°„ì— interactionì´ í•„ìš”í•˜ë‹¤ë©´ í•´ë‹¹ ì˜µì…˜ì„ ì‚¬ìš©. ë³¸ ì˜ˆì œì—ì„œëŠ” ì§€ì†ì ìœ¼ë¡œ ì¶œë ¥ë˜ëŠ” í™”ë©´ì„ ì‚¬ìš©ìê°€ ë³´ê¸° ìœ„í•´ì„œ ì‚¬ìš©. ì˜ˆë¥¼ë“¤ì–´ Python ëª…ë ¹ì´ í•„ìš”í•˜ê±°ë‚˜, ì¶”ê°€ì ìœ¼ë¡œ ë‹¤ë¥¸ ì…ë ¥ì„ ë°›ëŠ”ë‹¤ë©´ í•´ë‹¹ ì˜µì…˜ì„ ì§€ì •í•œ ë’¤ ì‚¬ìš©.

```py

~~~~~~~~~~~~~~~~~~~~~~~_~~~~~~~~~~_~~~~~~~~~~_  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
^^^^ ^^^  ^^^   ^,____(')<^ ,____(')= ^,____(')= ^^^    ^^^^      ^^^^ ^^^
^^^^      ^^^^    \~~= ') ^^ \~~= ')^   \~~= ')     ^^^    ^^     ^^^^
^^      ^^^^      ^^^    ^^^^^^  ^^      ^^^^      ^^^    ^^^^^^  ^^      ^^


                                                          \
                                               __        / \
                                             ><_'>     >=_('>
                                                '        \_/~~   
                                                          /|     
        .:/                                               /^\
     ,,///;,   ,;/                                       /   \
   o:::::::;;///                             _   _   _  /     \  _   _   _
  >::::::::;;\\\                            [ ]_[ ]_[ ]/ _   _ \[ ]_[ ]_[ ]
    ''\\''\\''\\''\                           [ ]_[ ]_[ ]/ _   _ \[ ]_[ ]_[ ]
```

# Docker CP & DockerFIle

## Docker containerì— íŒŒì¼ ë³µì‚¬

- ê²Œì„ server, Web serverì™€ ê°™ì´ ì‚¬ìš©í•  ë„êµ¬ê°€ docker imageì— ëª¨ë‘ êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°ë„ ìˆë‹¤.

1. Web serverëŠ” docker containerë¡œ ì‹¤í–‰
2. Web serverë¥¼ êµ¬ì„±í•˜ëŠ” íŒŒì¼ì€ ë§Œë“¤ê±°ë‚˜ ê°€ì ¸ì˜¨ êµ¬ì„±

- ì¥ì 
  - Serverì— ë¬¸ì œê°€ ìƒê¸°ëŠ” ê²ƒì„ Hostì™€ ë³„ê°œë¡œ íŒŒì•…
  - ë¬¸ì œê°€ ìƒê¸´ serverë¥¼ ë„ê³ , ë§ˆì¹˜ ê³µì¥ì´ˆê¸°í™”ë¥¼ í•˜ë“¯ docker imageë¡œ serverë¥¼ ì¬êµ¬ë™í•˜ê¸° ìš©ì˜í•¨

- Localì— ìˆëŠ” íŒŒì¼ê³¼ docker imageë¥¼ ì—°ê²°í•˜ëŠ” ë°©ë²•ì€ CPì™€ Docker Volume ê¸°ëŠ¥ì„ ì´ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë‚˜ë‰œë‹¤.
  - CP : í˜¸ìŠ¤íŠ¸ì™€ container ì‚¬ì´ì˜ íŒŒì¼ì„ ë³µì‚¬
  - Volume : í˜¸ìŠ¤íŠ¸ì™€ container ì‚¬ì´ì˜ ê³µê°„ì„ ë§ˆìš´íŠ¸

### httpd Web server

```
$ git clone https://github.com/codestates/pacman-canvas

$ docker container run --name my_web --rm -p 818:80 httpd
```

- `-p` : Local(í˜¸ìŠ¤íŠ¸)ì˜ í¬íŠ¸ì™€ containerì˜ í¬íŠ¸ì™€ ì—°ê²°
- `127.0.0.1:818` í˜¹ì€ `localhost:818`ì„ í†µí•´ Web serverê°€ ì‘ë™í•˜ê³  ìˆëŠ”ì§€ í™•ì¸

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-09-30 12 13 19](https://user-images.githubusercontent.com/79494088/135380048-434c73b1-88ba-451b-87f4-a92110bdf44e.png)

```
$ docker container cp ./ my_web:/usr/local/apache2/htdocs/
```

- `cp` : ì•ì— ì¸ìˆ˜ì˜ ê²½ë¡œë¥¼ ë’¤ì— ì¸ìˆ˜ì˜ ê²½ë¡œì— ë³µì‚¬
  - ê²½ë¡œëŠ” ë°˜ë“œì‹œ ë³µì‚¬í•  ê³³ìœ¼ë¡œ ì´ë™í•  ê²ƒ

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-09-30 12 14 46](https://user-images.githubusercontent.com/79494088/135380151-a5b6db09-9f46-4968-a545-099297bf224d.png)

## Make Doker Image
- Imageë¡œ ë§Œë“¤ì–´ ë†“ìœ¼ë©´ ì´ì „ì— ì‘ì—…í–ˆë˜ ë‚´ìš©ì„ ë‹¤ì‹œ í•œë²ˆ ìˆ˜í–‰í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ëŠ” ì ê³¼ ë°°í¬ ë° ê´€ë¦¬ê°€ ìœ ìš©í•˜ë‹¤.

### 1. êµ¬ë™í•œ Docker containerë¥¼ imageë¡œ

```
$ docker container commit my_web my_pacman:1.0

$ docker run --name my_web2 -p 900:80 my_pacman:1.0
```

- ìƒì„±ëœ imageë¥¼ ì´ìš©í•´ì„œ 900 í¬íŠ¸ì— ì›¹server êµ¬ë™
- `127.0.0.1:900` í˜¹ì€ `localhost:900` ì„ í†µí•´ Web serverê°€ ì‘ë™í•˜ê³  ìˆëŠ”ì§€ í™•ì¸

### 2. ë¹Œë“œë¥¼ ìœ„í•œ íŒŒì¼ì¸ Dockerfileë¡œ
- [Dockerfile documentation](https://docs.docker.com/engine/reference/builder/)
- Dockerfileì„ ë§Œë“¤ê³ , DockerfileëŒ€ë¡œ imageë¥¼ build

```py
# ë² ì´ìŠ¤ imageë¥¼ httpd:2.4ë¡œ ì‚¬ìš©
FROM httpd:2.4 
# í˜¸ìŠ¤íŠ¸ì˜ í˜„ì¬ê²½ë¡œì— ìˆëŠ” íŒŒì¼ì„ ìƒì„±í•  image /usr/local/apache2/htdocs/ ì— ë³µì‚¬
COPY ./ /usr/local/apache2/htdocs/ 

# --tag ëŠ” name:tag í˜•ì‹ìœ¼ë¡œ imageë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
# ì§€ì •í•œ ê²½ë¡œì— ìˆëŠ” Dockerfile ì„ ì°¾ì•„ì„œ ë¹Œë“œí•©ë‹ˆë‹¤.
$ docker build --tag my_pacman:2.0

# ìƒì„±ëœ imageë¥¼ ì´ìš©í•´ 901 í¬íŠ¸ì— ì›¹server êµ¬ë™
$ docker run --name my_web3 -p 901:80 my_pacman:2.0
```

# Reference
- [IPì™€ DNS, í¬íŠ¸(port) ì‰½ê²Œ ì´í•´í•˜ê¸°](https://deftkang.tistory.com/119)
- [serverë€ ë¬´ì—‡ì¼ê¹Œìš”?](https://youtu.be/R0YJ-r-qLNE)
- [Get Started with Docker](https://www.docker.com/get-started)
- [Docker Docs](https://docs.docker.com/engine/reference/builder/)
- [Docker Hub](https://hub.docker.com/)
- [Postgres in Docker Hub](https://hub.docker.com/_/postgres)
- [pgAdmin in Docker Hub](https://hub.docker.com/r/dpage/pgadmin4)
- [pgAdmin Docs](https://www.pgadmin.org/docs/pgadmin4/latest/container_deployment.html)
- [jmuppala github Repo](https://github.com/jmuppala)